# §21.5 Modular Transformations

:::{note}
**See also:**

Annotations for Ch.21
:::


## §21.5(i) Riemann Theta Functions

:::{note}
**Keywords:**

[Riemann theta functions](http://dlmf.nist.gov/search/search?q=Riemann%20theta%20functions) , [matrix](http://dlmf.nist.gov/search/search?q=matrix) , [modular group](http://dlmf.nist.gov/search/search?q=modular%20group) , [modular transformations](http://dlmf.nist.gov/search/search?q=modular%20transformations) , [symplectic](http://dlmf.nist.gov/search/search?q=symplectic)

**Notes:**

See Arnol′d ([1997](./bib/index.html#bib2728 "Mathematical Methods of Classical Mechanics"), p. 222) and Mumford ([1983](./bib/M.html#bib1681 "Tata Lectures on Theta. I"), pp. 189–210).

**See also:**

Annotations for §21.5 and Ch.21
:::

Let $\mathbf{A}$ , $\mathbf{B}$ , $\mathbf{C}$ , and $\mathbf{D}$ be $g\times g$ matrices with integer elements such that


<a id="E1"></a>
$$
\boldsymbol{{\Gamma}}=\begin{bmatrix}\mathbf{A}&\mathbf{B}\\
\mathbf{C}&\mathbf{D}\end{bmatrix} \tag{21.5.1}
$$

is a *symplectic matrix* , that is,


<a id="E2"></a>
$$
\boldsymbol{{\Gamma}}\mathbf{J}_{2g}\boldsymbol{{\Gamma}}^{\mathrm{T}}=\mathbf{J}_{2g}. \tag{21.5.2}
$$

Then


<a id="E3"></a>
$$
\det\boldsymbol{{\Gamma}}=1, \tag{21.5.3}
$$

and


<a id="E4"></a>
$$
\theta\left(\left[[\mathbf{C}\boldsymbol{{\Omega}}+\mathbf{D}]^{-1}\right]^{\mathrm{T}}\mathbf{z}\middle|[\mathbf{A}\boldsymbol{{\Omega}}+\mathbf{B}][\mathbf{C}\boldsymbol{{\Omega}}+\mathbf{D}]^{-1}\right)=\xi(\boldsymbol{{\Gamma}})\sqrt{\det[\mathbf{C}\boldsymbol{{\Omega}}+\mathbf{D}]}e^{\pi i\mathbf{z}\cdot\left[[\mathbf{C}\boldsymbol{{\Omega}}+\mathbf{D}]^{-1}\mathbf{C}\right]\cdot\mathbf{z}}\theta\left(\mathbf{z}\middle|\boldsymbol{{\Omega}}\right). \tag{21.5.4}
$$

Here $\xi(\boldsymbol{{\Gamma}})$ is an eighth root of unity, that is, $(\xi(\boldsymbol{{\Gamma}}))^{8}=1$ . For general $\boldsymbol{{\Gamma}}$ , it is difficult to decide which root needs to be used. The choice depends on $\boldsymbol{{\Gamma}}$ , but is independent of $\mathbf{z}$ and $\boldsymbol{{\Omega}}$ . Equation ( 21.5.4 ) is the *modular transformation* property for Riemann theta functions.

The modular transformations form a group under the composition of such transformations, the *modular group* , which is generated by simpler transformations, for which $\xi(\boldsymbol{{\Gamma}})$ is determinate:


<a id="E5"></a>
$$
\boldsymbol{{\Gamma}}=\begin{bmatrix}\mathbf{A}&\boldsymbol{{0}}_{g}\\
\boldsymbol{{0}}_{g}&[\mathbf{A}^{-1}]^{\mathrm{T}}\end{bmatrix}\Rightarrow\theta\left(\mathbf{A}\mathbf{z}\middle|\mathbf{A}\boldsymbol{{\Omega}}\mathbf{A}^{\mathrm{T}}\right)=\theta\left(\mathbf{z}\middle|\boldsymbol{{\Omega}}\right). \tag{21.5.5}
$$

( $\mathbf{A}$ invertible with integer elements.)


<a id="E6"></a>
$$
\boldsymbol{{\Gamma}}=\begin{bmatrix}\mathbf{I}_{g}&\mathbf{B}\\
\boldsymbol{{0}}_{g}&\mathbf{I}_{g}\end{bmatrix}\Rightarrow\theta\left(\mathbf{z}\middle|\boldsymbol{{\Omega}}+\mathbf{B}\right)=\theta\left(\mathbf{z}\middle|\boldsymbol{{\Omega}}\right). \tag{21.5.6}
$$

( $\mathbf{B}$ symmetric with integer elements and even diagonal elements.)


<a id="E7"></a>
$$
\boldsymbol{{\Gamma}}=\begin{bmatrix}\mathbf{I}_{g}&\mathbf{B}\\
\boldsymbol{{0}}_{g}&\mathbf{I}_{g}\end{bmatrix}\Rightarrow\theta\left(\mathbf{z}\middle|\boldsymbol{{\Omega}}+\mathbf{B}\right)=\theta\left(\mathbf{z}+\tfrac{1}{2}\operatorname{diag}\mathbf{B}\middle|\boldsymbol{{\Omega}}\right). \tag{21.5.7}
$$

( $\mathbf{B}$ symmetric with integer elements.) See Heil ([1995](./bib/H.html#bib1061 "Numerical Tools for the Study of Finite Gap Solutions of Integrable Systems"), p. 24). For a $g\times g$ matrix ${\bf A}$ we define $\operatorname{diag}\mathbf{A}$ , as a column vector with the diagonal entries as elements.

<a id="E8"></a>

<a id="Ex1"></a>
$$
\displaystyle\boldsymbol{{\Gamma}} \displaystyle=\begin{bmatrix}\boldsymbol{{0}}_{g}&-\mathbf{I}_{g}\\
\mathbf{I}_{g}&\boldsymbol{{0}}_{g}\end{bmatrix} \tag{21.5.8}
$$

<a id="Ex2"></a>
$$
\displaystyle\theta\left(\boldsymbol{{\Omega}}^{-1}\mathbf{z}\middle|-\boldsymbol{{\Omega}}^{-1}\right) \displaystyle=\sqrt{\det\left[-i\boldsymbol{{\Omega}}\right]}e^{\pi i\mathbf{z}\cdot\boldsymbol{{\Omega}}^{-1}\cdot\mathbf{z}}\theta\left(\mathbf{z}\middle|\boldsymbol{{\Omega}}\right),
$$

:::{note}
**Symbols:**

$\theta\left(\NVar{\mathbf{z}}\middle|\NVar{\boldsymbol{{\Omega}}}\right)$: Riemann theta function , $\pi$: the ratio of the circumference of a circle to its diameter , $\det$: determinant , $\mathrm{e}$: base of natural logarithm , $\mathrm{i}$: imaginary unit , $g$: positive integer , $\boldsymbol{{\Omega}}$: a Riemann matrix and Matrix $\boldsymbol{{\Gamma}}$

**Addition (effective with 1.0.11):**

A sentence was added at the end of ( 21.5.7 ) to define a diagonal matrix. *Suggested 2015-10-27 by Howard Cohl and Adri Olde Daalhuis*

**See also:**

Annotations for §21.5(i) , §21.5 and Ch.21
:::

where the square root assumes its principal value.


## §21.5(ii) Riemann Theta Functions with Characteristics

:::{note}
**Keywords:**

[Riemann theta functions](http://dlmf.nist.gov/search/search?q=Riemann%20theta%20functions) , [Riemann theta functions with characteristics](http://dlmf.nist.gov/search/search?q=Riemann%20theta%20functions%20with%20characteristics) , [modular transformations](http://dlmf.nist.gov/search/search?q=modular%20transformations)

**Notes:**

See Igusa ([1972](./bib/I.html#bib1121 "Theta Functions"), pp. 78–85).

**Referenced by:**

§20.11(iv)

**See also:**

Annotations for §21.5 and Ch.21
:::


<a id="E9"></a>
$$
\theta\genfrac{[}{]}{0.0pt}{}{\mathbf{D}\boldsymbol{{\alpha}}-\mathbf{C}\boldsymbol{{\beta}}+\tfrac{1}{2}\operatorname{diag}[\mathbf{C}\mathbf{D}^{\mathrm{T}}]}{-\mathbf{B}\boldsymbol{{\alpha}}+\mathbf{A}\boldsymbol{{\beta}}+\tfrac{1}{2}\operatorname{diag}[\mathbf{A}\mathbf{B}^{\mathrm{T}}]}\left(\left[[\mathbf{C}\boldsymbol{{\Omega}}+\mathbf{D}]^{-1}\right]^{\mathrm{T}}\mathbf{z}\middle|[\mathbf{A}\boldsymbol{{\Omega}}+\mathbf{B}][\mathbf{C}\boldsymbol{{\Omega}}+\mathbf{D}]^{-1}\right)=\kappa(\boldsymbol{{\alpha}},\boldsymbol{{\beta}},\boldsymbol{{\Gamma}})\sqrt{\det[\mathbf{C}\boldsymbol{{\Omega}}+\mathbf{D}]}e^{\pi i\mathbf{z}\cdot\left[[\mathbf{C}\boldsymbol{{\Omega}}+\mathbf{D}]^{-1}\mathbf{C}\right]\cdot\mathbf{z}}\theta\genfrac{[}{]}{0.0pt}{}{\boldsymbol{{\alpha}}}{\boldsymbol{{\beta}}}\left(\mathbf{z}\middle|\boldsymbol{{\Omega}}\right), \tag{21.5.9}
$$

where $\kappa(\boldsymbol{{\alpha}},\boldsymbol{{\beta}},\boldsymbol{{\Gamma}})$ is a complex number that depends on $\boldsymbol{{\alpha}}$ , $\boldsymbol{{\beta}}$ , and $\boldsymbol{{\Gamma}}$ . However, $\kappa(\boldsymbol{{\alpha}},\boldsymbol{{\beta}},\boldsymbol{{\Gamma}})$ is independent of $\mathbf{z}$ and $\boldsymbol{{\Omega}}$ . For explicit results in the case $g=1$ , see § 20.7(viii) .
